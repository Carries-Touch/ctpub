function ApplicationMessage(e,t){message=JSON.stringify({name:e,content:t}),function(e){window.application&&window.application.sendMessage&&window.application.sendMessage(e)}(message),function(e){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.application&&window.webkit.messageHandlers.application.postMessage(e)}(message)}function SurveyRunner(e,t,a){const o=`ct-survey:${e}`;function n(){window.localStorage.setItem(o,JSON.stringify({completed:"completed"==s.state,pageNo:s.currentPageNo,data:s.data}))}const s=new Survey.Model(t);var i;(i=window.localStorage.getItem(o)||null)&&(i=JSON.parse(i),s.data=i.data,i.completed?s.doComplete():i.pageNo&&(s.start(),s.currentPageNo=i.pageNo)),s.onValueChanged.add(n),s.onCurrentPageChanged.add(n),s.onStarted.add(n),$("#surveyContainer").Survey({model:s}),s.onAfterRenderQuestion.add((()=>{if(s.isShowStartingPage)document.getElementsByTagName("body")[0].classList.add("start");else{const e=document.getElementsByTagName("body")[0];e.classList.remove("question-"+s.currentPageNo),e.classList.add("question","question-"+(s.currentPageNo+1))}})),s.onComplete.add((function(){document.getElementsByTagName("body")[0].classList.add("complete"),n(),a.postResults&&a.surveyID&&a.postID&&fetch("https://api.surveyjs.io/public/Survey/post",{method:"POST",body:JSON.stringify({PostID:a.postID,SurveyResult:JSON.stringify(s.data)}),headers:{"Content-Type":"application/json"}}).then((e=>{console.log(e)})).catch((e=>{console.error(e)}));var e={results:s.data};if(a.onCollectCompleteMessageData){let t=a.onCollectCompleteMessageData(s);e={...e,...t}}ApplicationMessage("complete",e)})),$(document).on("click",".template-action-button.start-quiz",(e=>{s.start()})),$(document).on("click",".template-action-button.restart-quiz",(e=>{window.localStorage.removeItem(o),s.clear()})),$(document).on("click",".template-action-button.exit",(e=>{ApplicationMessage("exit",{})})),window.previousPage=function(){return"completed"!=s.state&&s.prevPage()}}
