function SendMessageAndroid(e){window.application&&window.application.sendAppMessage&&window.application.sendAppMessage(e)}function SendMessageIOS(e){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.application&&window.webkit.messageHandlers.application.postMessage(e)}function SurveyRunner(e,t,o){const a=`ct-survey:${e}`;function n(){window.localStorage.setItem(a,JSON.stringify({completed:"completed"==i.state,pageNo:i.currentPageNo,data:i.data}))}function s(e,t){message=JSON.stringify({name:e,content:t}),SendMessageAndroid(message),SendMessageIOS(message)}const i=new Survey.Model(t);var d;(d=window.localStorage.getItem(a)||null)&&(d=JSON.parse(d),i.data=d.data,d.completed?i.doComplete():d.pageNo&&(i.start(),i.currentPageNo=d.pageNo)),i.onValueChanged.add(n),i.onCurrentPageChanged.add(n),i.onStarted.add(n),$("#surveyContainer").Survey({model:i}),i.onAfterRenderQuestion.add((()=>{if(i.isShowStartingPage)document.getElementsByTagName("body")[0].classList.add("start");else{const e=document.getElementsByTagName("body")[0];e.classList.remove("question-"+i.currentPageNo),e.classList.add("question","question-"+(i.currentPageNo+1))}})),i.onComplete.add((function(){document.getElementsByTagName("body")[0].classList.add("complete"),n();var e=[];for(const[t,o]of Object.entries(i.data)){const a=i.getQuestionByName(t);a&&a.choices.filter((t=>{t.jsonObj.value==o&&e.push({question:a.title,answer:t.jsonObj})}))}var t={answers:e};if(o.onCollectCompleteMessageData){const e=o.onCollectCompleteMessageData(i);t={...t,...e}}s("complete",t),o.postResults&&o.surveyID&&o.postID&&fetch("https://api.surveyjs.io/public/Survey/post",{method:"POST",body:JSON.stringify({PostID:o.postID,SurveyResult:JSON.stringify(i.data)}),headers:{"Content-Type":"application/json"}}).then((e=>{console.log(e)})).catch((e=>{console.error(e)}))})),$(document).on("click",".template-action-button.start-quiz",(e=>{i.start()})),$(document).on("click",".template-action-button.restart-quiz",(e=>{window.localStorage.removeItem(a),i.clear()})),window.previousPage=function(){return"completed"!=i.state&&i.prevPage()}}
